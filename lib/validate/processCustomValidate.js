"use strict";

// Generated by CoffeeScript 2.5.1
(function () {
  var Result, processCustomValidate;
  Result = require('../result');

  processCustomValidate = function processCustomValidate(result, fieldDesc, fieldsLevel, docDesc, validators) {
    var _this = this;

    var ei, name, params, si, validate;

    if (!fieldDesc.hasOwnProperty('validate')) {
      return;
    }

    validate = fieldDesc.validate.trim();
    si = validate.indexOf('(');
    ei = validate.indexOf(')');

    if (!(!~si && !~ei || ~si && ei === validate.length - 1)) {
      result.error(function (path) {
        return Result.prop('validate')(path);
      }, 'dsc.invalidValue', {
        value: validate
      });
    } else {
      if (~si) {
        name = validate.substr(0, si);
        params = validate.substr(si + 1, ei - si - 1);
      } else {
        name = validate;
      }

      if (typeof (validators != null ? validators[name] : void 0) !== 'function') {
        result.error(function (path) {
          return Result.prop('validate')(path);
        }, 'dsc.unknownValidator', {
          value: validate
        });
      } else {
        return result.context(function (path) {
          return Result.prop('validate')(path);
        }, function () {
          return validators[name].call(_this, result, fieldDesc, params, fieldsLevel, docDesc, validate); // processCustomValidate =
        });
      }
    }
  }; // ----------------------------


  module.exports = processCustomValidate;
}).call(void 0);